[![License](https://img.shields.io/badge/License-GNU%20GPLv3-green)](./LICENSE) [![DOI](https://zenodo.org/badge/349075288.svg)](https://zenodo.org/record/7252232#.Y7yNv6fMJhG) [![DOI](https://img.shields.io/badge/DOI-10.1145%2F3313828%20-orange)](https://doi.org/10.48550/arXiv.2210.13495) [![DOI](https://img.shields.io/badge/DOI-10.1002%2Fcpe.3394%20-orange)](http://dx.doi.org/10.23919/mipro55190.2022.9803591)

# Entanglement cooling algorithm

The **Entanglement cooling algorithm** computes the statistical properties of the entanglement spectrum by applying a Metropolis-like entanglement cooling algorithm generated by different sets of local gates, on states sharing the same statistic. The initial states are the ground states of the one-dimensional quantum Ising model in its different macroscopic phases (paramagnetic, the magnetically ordered and the topologically frustrated).

The code is developed at the [Ruđer Bošković Institute](https://www.irb.hr/) by the Condensed Matter and Statistical Physics Group and the [Centre for Informatics and Computing](https://cir.com.hr/)

The code is written in Python which enables straightforward portability over different computational platforms. The code supports execution on shared memory systems (manycore and multi-CPU systems) and on distributed GPUs systems using the Message Passing Interface (MPI).

The development of the code was supported by the Croatia Science Foundation through the project UIP-2020-02-4559 "Scalable high-performance algorithms for future heterogeneous distributed computer systems"([HybridScale](https://www.croris.hr/projekti/projekt/6243?lang=en)).

## Dependencies

The list of required Python libraries and other dependencies is given in the file [Requirements.txt](./Requirements.txt)

- conda
- numpy
- scipy
- mpi4py (for distributed support)
- cupy (for GPU versions)
- ???

## Quick start

### Cloning the code

```
git clone https://github.com/HybridScale/Entanglement-Cooling-Algorithm.git
```

### Python envirnoments 
Repository provides file `Requirements.txt` with Python packages needed for simulation. To create new Virtual Envirnoment in Python with Conda and install all required packages:
```
conda create --name ENVNAME --file Requirements.txt
```
### Running
Repository provide [src/main.py](main.py) script, which implements cli interface.  
Run `python src/main.py -h` to get info on execution versions. Algorithm can execute on CPU and GPU. 
GPU simulation have two options, either run one simulation (`GPU`) or run multiple simulations packed on single GPU (`batchedGEMM`) into one batched operation.

Execution of simulation can be resumed from last simulation step with same initial parameters.
Run next command to chech options:
```
python src/main.phy {CPU,GPU,batchedGEMM} -h
```

Use positional arguments to choose desired version. Cli also provides information on the rich execution simulation options and parameters.
```
python src/main.phy {CPU, GPU, batchedGEMM} {new, resume}-h
```

#### Multiple simulation
Using `MPI` multiple simulations can be calculated at the same time. 

```
mpirun -n N python src/main.py GPU new --N 19 --R 9 --L 2.5 --MC 1000 -w 10000000
```

```bash
cd Entanglement-Cooling-Algorithm/
mkdir run && cd run

```
### Examples

To be done

## Fine-tune the execution

To be done

## Developers

### The main code

- Jovan Odavić 
- Gianpaolo Torre
- Fabio Franchini
- Salvatore Marco Gaimpaolo

### GPU parallelisation and code optimisation

- Davor Davidović
- Nenad Mijić

## Contribution

This repository mirrors the principal repository of the code on Bitbucket. If you want to contribute to the code please contact davor.davidovic@irb.hr or jovan.odavic@irb.hr

## How to cite the code

Description of the computational model and the entanglement cooling with Metropolis Monte Carlo:

J. Odavić, G. Torre, N. Mijić, D. Davidović, F. Franchini, S. M. Giampaolo.  *Random unitaries, Robustness, and Complexity of Entanglement*. [arXiv:2210.13495](https://doi.org/10.48550/arXiv.2210.13495)

The code and parallelisation on distributed multi-GPU computing architectures:

N. Mijic, D. Davidovic. *Batched matrix operations on distributed GPUs with application in theoretical physics.* 45th Jubilee International Convention on Information, Communication and Electronic Technology (MIPRO), 2022, pp. 293-299, [doi: 10.23919/MIPRO55190.2022.9803591](http://dx.doi.org/10.23919/mipro55190.2022.9803591).


The full paper is available [here](http://fulir.irb.hr/7514/).

## Copyright and License

This code is published under GNU General Public License v3.0 ([GNU GPLv3](./LICENSE))